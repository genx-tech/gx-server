"use strict";

require("source-map-support/register");

const _ = require('rk-utils')._;

const {
  InvalidConfiguration
} = require('../utils/Errors');

exports.requireFeatures = function (features, app, middleware) {
  let hasNotEnabled = _.find(_.castArray(features), feature => !app.enabled(feature));

  if (hasNotEnabled) {
    throw new InvalidConfiguration(`Middleware "${middleware}" requires "${hasNotEnabled}" feature to be enabled.`, app, `middlewares.${middleware}`);
  }
};

exports.hasMethod = function hasMethod(obj, name) {
  const desc = Object.getOwnPropertyDescriptor(obj, name);
  let has = !!desc && typeof desc.value === 'function';
  if (has) return true;
  let proto = Object.getPrototypeOf(obj);
  if (proto === Object.prototype) return has;
  return hasMethod(proto, name);
};

exports.withStatus = (Base, STATUS) => class extends Base {
  constructor(...args) {
    super(...args);
    this.status = STATUS;
  }

};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9IZWxwZXJzLmpzIl0sIm5hbWVzIjpbIl8iLCJyZXF1aXJlIiwiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJleHBvcnRzIiwicmVxdWlyZUZlYXR1cmVzIiwiZmVhdHVyZXMiLCJhcHAiLCJtaWRkbGV3YXJlIiwiaGFzTm90RW5hYmxlZCIsImZpbmQiLCJjYXN0QXJyYXkiLCJmZWF0dXJlIiwiZW5hYmxlZCIsImhhc01ldGhvZCIsIm9iaiIsIm5hbWUiLCJkZXNjIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiaGFzIiwidmFsdWUiLCJwcm90byIsImdldFByb3RvdHlwZU9mIiwicHJvdG90eXBlIiwid2l0aFN0YXR1cyIsIkJhc2UiLCJTVEFUVVMiLCJzdGF0dXMiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFQLENBQW9CRCxDQUE5Qjs7QUFDQSxNQUFNO0FBQUVFLEVBQUFBO0FBQUYsSUFBMkJELE9BQU8sQ0FBQyxpQkFBRCxDQUF4Qzs7QUFFQUUsT0FBTyxDQUFDQyxlQUFSLEdBQTBCLFVBQVVDLFFBQVYsRUFBb0JDLEdBQXBCLEVBQXlCQyxVQUF6QixFQUFxQztBQUMzRCxNQUFJQyxhQUFhLEdBQUdSLENBQUMsQ0FBQ1MsSUFBRixDQUFPVCxDQUFDLENBQUNVLFNBQUYsQ0FBWUwsUUFBWixDQUFQLEVBQThCTSxPQUFPLElBQUksQ0FBQ0wsR0FBRyxDQUFDTSxPQUFKLENBQVlELE9BQVosQ0FBMUMsQ0FBcEI7O0FBRUEsTUFBSUgsYUFBSixFQUFtQjtBQUNmLFVBQU0sSUFBSU4sb0JBQUosQ0FDRCxlQUFjSyxVQUFXLGVBQWNDLGFBQWMsMEJBRHBELEVBRUZGLEdBRkUsRUFHRCxlQUFjQyxVQUFXLEVBSHhCLENBQU47QUFLSDtBQUNKLENBVkQ7O0FBWUFKLE9BQU8sQ0FBQ1UsU0FBUixHQUFvQixTQUFTQSxTQUFULENBQW1CQyxHQUFuQixFQUF3QkMsSUFBeEIsRUFBOEI7QUFDOUMsUUFBTUMsSUFBSSxHQUFHQyxNQUFNLENBQUNDLHdCQUFQLENBQWdDSixHQUFoQyxFQUFxQ0MsSUFBckMsQ0FBYjtBQUNBLE1BQUlJLEdBQUcsR0FBRyxDQUFDLENBQUNILElBQUYsSUFBVSxPQUFPQSxJQUFJLENBQUNJLEtBQVosS0FBc0IsVUFBMUM7QUFDQSxNQUFJRCxHQUFKLEVBQVMsT0FBTyxJQUFQO0FBRVQsTUFBSUUsS0FBSyxHQUFHSixNQUFNLENBQUNLLGNBQVAsQ0FBc0JSLEdBQXRCLENBQVo7QUFDQSxNQUFJTyxLQUFLLEtBQUtKLE1BQU0sQ0FBQ00sU0FBckIsRUFBZ0MsT0FBT0osR0FBUDtBQUVoQyxTQUFPTixTQUFTLENBQUNRLEtBQUQsRUFBUU4sSUFBUixDQUFoQjtBQUNILENBVEQ7O0FBaUJBWixPQUFPLENBQUNxQixVQUFSLEdBQXFCLENBQUNDLElBQUQsRUFBT0MsTUFBUCxLQUFrQixjQUFjRCxJQUFkLENBQW1CO0FBQUE7QUFBQTtBQUFBLFNBS3RERSxNQUxzRCxHQUs3Q0QsTUFMNkM7QUFBQTs7QUFBQSxDQUExRCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBfID0gcmVxdWlyZSgncmstdXRpbHMnKS5fO1xuY29uc3QgeyBJbnZhbGlkQ29uZmlndXJhdGlvbiB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvRXJyb3JzJyk7XG5cbmV4cG9ydHMucmVxdWlyZUZlYXR1cmVzID0gZnVuY3Rpb24gKGZlYXR1cmVzLCBhcHAsIG1pZGRsZXdhcmUpIHtcbiAgICBsZXQgaGFzTm90RW5hYmxlZCA9IF8uZmluZChfLmNhc3RBcnJheShmZWF0dXJlcyksIGZlYXR1cmUgPT4gIWFwcC5lbmFibGVkKGZlYXR1cmUpKTtcblxuICAgIGlmIChoYXNOb3RFbmFibGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkQ29uZmlndXJhdGlvbihcbiAgICAgICAgICAgIGBNaWRkbGV3YXJlIFwiJHttaWRkbGV3YXJlfVwiIHJlcXVpcmVzIFwiJHtoYXNOb3RFbmFibGVkfVwiIGZlYXR1cmUgdG8gYmUgZW5hYmxlZC5gLFxuICAgICAgICAgICAgYXBwLFxuICAgICAgICAgICAgYG1pZGRsZXdhcmVzLiR7bWlkZGxld2FyZX1gXG4gICAgICAgICk7XG4gICAgfVxufTtcblxuZXhwb3J0cy5oYXNNZXRob2QgPSBmdW5jdGlvbiBoYXNNZXRob2Qob2JqLCBuYW1lKSB7XG4gICAgY29uc3QgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBuYW1lKTsgICAgXG4gICAgbGV0IGhhcyA9ICEhZGVzYyAmJiB0eXBlb2YgZGVzYy52YWx1ZSA9PT0gJ2Z1bmN0aW9uJztcbiAgICBpZiAoaGFzKSByZXR1cm4gdHJ1ZTtcblxuICAgIGxldCBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopO1xuICAgIGlmIChwcm90byA9PT0gT2JqZWN0LnByb3RvdHlwZSkgcmV0dXJuIGhhcztcblxuICAgIHJldHVybiBoYXNNZXRob2QocHJvdG8sIG5hbWUpO1xufTtcblxuLyoqXG4gKiBBZGRzIGEgc3RhdHVzIHByb3BlcnR5IHRvIHRoZSBjbGFzcy5cbiAqIEBtaXhpblxuICogQHBhcmFtIHsqfSBCYXNlIFxuICogQHBhcmFtIHsqfSBTVEFUVVMgXG4gKi9cbmV4cG9ydHMud2l0aFN0YXR1cyA9IChCYXNlLCBTVEFUVVMpID0+IGNsYXNzIGV4dGVuZHMgQmFzZSB7XG4gICAgLyoqXG4gICAgICogU3RhdHVzIGNvZGUuXG4gICAgICogQG1lbWJlciB7bnVtYmVyfVxuICAgICAqL1xuICAgIHN0YXR1cyA9IFNUQVRVUztcbn07Il19