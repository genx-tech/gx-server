"use strict";

require("source-map-support/register");

const {
  InvalidConfiguration
} = require('../utils/Errors');

let createMiddleware = (opt, app) => {
  if (!opt || !opt.strategy) {
    throw new InvalidConfiguration('Missing strategy name.', app, 'middlewares.passportAuth.strategy');
  }

  let passportService = app.getService('passport');

  if (!passportService) {
    throw new InvalidConfiguration('Passport feature is not enabled.', app, 'passport');
  }

  return passportService.authenticate(opt.strategy, opt.options);
};

module.exports = createMiddleware;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlcy9wYXNzcG9ydEF1dGguanMiXSwibmFtZXMiOlsiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJyZXF1aXJlIiwiY3JlYXRlTWlkZGxld2FyZSIsIm9wdCIsImFwcCIsInN0cmF0ZWd5IiwicGFzc3BvcnRTZXJ2aWNlIiwiZ2V0U2VydmljZSIsImF1dGhlbnRpY2F0ZSIsIm9wdGlvbnMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU07QUFBRUEsRUFBQUE7QUFBRixJQUEyQkMsT0FBTyxDQUFDLGlCQUFELENBQXhDOztBQWVBLElBQUlDLGdCQUFnQixHQUFHLENBQUNDLEdBQUQsRUFBTUMsR0FBTixLQUFjO0FBQ2pDLE1BQUksQ0FBQ0QsR0FBRCxJQUFRLENBQUNBLEdBQUcsQ0FBQ0UsUUFBakIsRUFBMkI7QUFDdkIsVUFBTSxJQUFJTCxvQkFBSixDQUNGLHdCQURFLEVBRUZJLEdBRkUsRUFHRixtQ0FIRSxDQUFOO0FBS0g7O0FBRUQsTUFBSUUsZUFBZSxHQUFHRixHQUFHLENBQUNHLFVBQUosQ0FBZSxVQUFmLENBQXRCOztBQUVBLE1BQUksQ0FBQ0QsZUFBTCxFQUFzQjtBQUNsQixVQUFNLElBQUlOLG9CQUFKLENBQ0Ysa0NBREUsRUFFRkksR0FGRSxFQUdGLFVBSEUsQ0FBTjtBQUtIOztBQUVELFNBQU9FLGVBQWUsQ0FBQ0UsWUFBaEIsQ0FBNkJMLEdBQUcsQ0FBQ0UsUUFBakMsRUFBMkNGLEdBQUcsQ0FBQ00sT0FBL0MsQ0FBUDtBQUNILENBcEJEOztBQXNCQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCVCxnQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY29uc3QgeyBJbnZhbGlkQ29uZmlndXJhdGlvbiB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvRXJyb3JzJyk7XG5cbi8qKlxuICogUGFzc3BvcnQgaW5pdGlhbGl6YXRpb24gbWlkZGxld2FyZSwgcmVxdWlyZWQgdG8gaW5pdGlhbGl6ZSBQYXNzcG9ydCBzZXJ2aWNlLlxuICogQG1vZHVsZSBNaWRkbGV3YXJlX1Bhc3Nwb3J0QXV0aFxuICovXG5cbi8qKlxuICogQ3JlYXRlIGEgcGFzc3BvcnQgYXV0aGVudGljYXRpb24gbWlkZGxld2FyZS5cbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHQgLSBQYXNzcG9ydCBvcHRpb25zXG4gKiBAcHJvcGVydHkge3N0cmluZ30gb3B0LnN0cmF0ZWd5IC0gUGFzc3BvcnQgc3RyYXRlZ3lcbiAqIEBwcm9wZXJ0eSB7b2JqZWN0fSBbb3B0Lm9wdGlvbnNdIC0gUGFzc3BvcnQgc3RyYXRlZ3kgb3B0aW9uc1xuICogQHBhcmFtIHtSb3V0YWJsZX0gYXBwXG4gKiBAcmV0dXJucyB7S29hQWN0aW9uRnVuY3Rpb259XG4gKi9cbmxldCBjcmVhdGVNaWRkbGV3YXJlID0gKG9wdCwgYXBwKSA9PiB7XG4gICAgaWYgKCFvcHQgfHwgIW9wdC5zdHJhdGVneSkge1xuICAgICAgICB0aHJvdyBuZXcgSW52YWxpZENvbmZpZ3VyYXRpb24oXG4gICAgICAgICAgICAnTWlzc2luZyBzdHJhdGVneSBuYW1lLicsIFxuICAgICAgICAgICAgYXBwLCBcbiAgICAgICAgICAgICdtaWRkbGV3YXJlcy5wYXNzcG9ydEF1dGguc3RyYXRlZ3knXG4gICAgICAgICk7XG4gICAgfSAgICBcbiAgICBcbiAgICBsZXQgcGFzc3BvcnRTZXJ2aWNlID0gYXBwLmdldFNlcnZpY2UoJ3Bhc3Nwb3J0Jyk7XG5cbiAgICBpZiAoIXBhc3Nwb3J0U2VydmljZSkge1xuICAgICAgICB0aHJvdyBuZXcgSW52YWxpZENvbmZpZ3VyYXRpb24oXG4gICAgICAgICAgICAnUGFzc3BvcnQgZmVhdHVyZSBpcyBub3QgZW5hYmxlZC4nLFxuICAgICAgICAgICAgYXBwLFxuICAgICAgICAgICAgJ3Bhc3Nwb3J0J1xuICAgICAgICApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcGFzc3BvcnRTZXJ2aWNlLmF1dGhlbnRpY2F0ZShvcHQuc3RyYXRlZ3ksIG9wdC5vcHRpb25zKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlTWlkZGxld2FyZTsiXX0=