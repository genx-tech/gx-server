"use strict";

require("source-map-support/register");

const _ = require('rk-utils')._;

const {
  InvalidConfiguration
} = require('../utils/Errors');

const Literal = require('../enum/Literal');

exports.requireFeatures = function (features, app, middleware) {
  let hasNotEnabled = _.find(_.castArray(features), feature => !app.enabled(feature));

  if (hasNotEnabled) {
    throw new InvalidConfiguration(`Middleware "${middleware}" requires "${hasNotEnabled}" feature to be enabled.`, app, `middlewares.${middleware}`);
  }
};

exports.hasMethod = function hasMethod(obj, name) {
  const desc = Object.getOwnPropertyDescriptor(obj, name);
  let has = !!desc && typeof desc.value === 'function';
  if (has) return true;
  let proto = Object.getPrototypeOf(obj);
  if (proto === Object.prototype) return has;
  return hasMethod(proto, name);
};

exports.defaultBackendPath = process.env.NODE_RT && process.env.NODE_RT === 'babel' ? Literal.BACKEND_SRC_PATH : Literal.BACKEND_PATH;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9IZWxwZXJzLmpzIl0sIm5hbWVzIjpbIl8iLCJyZXF1aXJlIiwiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJMaXRlcmFsIiwiZXhwb3J0cyIsInJlcXVpcmVGZWF0dXJlcyIsImZlYXR1cmVzIiwiYXBwIiwibWlkZGxld2FyZSIsImhhc05vdEVuYWJsZWQiLCJmaW5kIiwiY2FzdEFycmF5IiwiZmVhdHVyZSIsImVuYWJsZWQiLCJoYXNNZXRob2QiLCJvYmoiLCJuYW1lIiwiZGVzYyIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImhhcyIsInZhbHVlIiwicHJvdG8iLCJnZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsImRlZmF1bHRCYWNrZW5kUGF0aCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX1JUIiwiQkFDS0VORF9TUkNfUEFUSCIsIkJBQ0tFTkRfUEFUSCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFFQSxNQUFNQSxDQUFDLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQVAsQ0FBb0JELENBQTlCOztBQUNBLE1BQU07QUFBRUUsRUFBQUE7QUFBRixJQUEyQkQsT0FBTyxDQUFDLGlCQUFELENBQXhDOztBQUNBLE1BQU1FLE9BQU8sR0FBR0YsT0FBTyxDQUFDLGlCQUFELENBQXZCOztBQUVBRyxPQUFPLENBQUNDLGVBQVIsR0FBMEIsVUFBVUMsUUFBVixFQUFvQkMsR0FBcEIsRUFBeUJDLFVBQXpCLEVBQXFDO0FBQzNELE1BQUlDLGFBQWEsR0FBR1QsQ0FBQyxDQUFDVSxJQUFGLENBQU9WLENBQUMsQ0FBQ1csU0FBRixDQUFZTCxRQUFaLENBQVAsRUFBOEJNLE9BQU8sSUFBSSxDQUFDTCxHQUFHLENBQUNNLE9BQUosQ0FBWUQsT0FBWixDQUExQyxDQUFwQjs7QUFFQSxNQUFJSCxhQUFKLEVBQW1CO0FBQ2YsVUFBTSxJQUFJUCxvQkFBSixDQUNELGVBQWNNLFVBQVcsZUFBY0MsYUFBYywwQkFEcEQsRUFFRkYsR0FGRSxFQUdELGVBQWNDLFVBQVcsRUFIeEIsQ0FBTjtBQUtIO0FBQ0osQ0FWRDs7QUFZQUosT0FBTyxDQUFDVSxTQUFSLEdBQW9CLFNBQVNBLFNBQVQsQ0FBbUJDLEdBQW5CLEVBQXdCQyxJQUF4QixFQUE4QjtBQUM5QyxRQUFNQyxJQUFJLEdBQUdDLE1BQU0sQ0FBQ0Msd0JBQVAsQ0FBZ0NKLEdBQWhDLEVBQXFDQyxJQUFyQyxDQUFiO0FBQ0EsTUFBSUksR0FBRyxHQUFHLENBQUMsQ0FBQ0gsSUFBRixJQUFVLE9BQU9BLElBQUksQ0FBQ0ksS0FBWixLQUFzQixVQUExQztBQUNBLE1BQUlELEdBQUosRUFBUyxPQUFPLElBQVA7QUFFVCxNQUFJRSxLQUFLLEdBQUdKLE1BQU0sQ0FBQ0ssY0FBUCxDQUFzQlIsR0FBdEIsQ0FBWjtBQUNBLE1BQUlPLEtBQUssS0FBS0osTUFBTSxDQUFDTSxTQUFyQixFQUFnQyxPQUFPSixHQUFQO0FBRWhDLFNBQU9OLFNBQVMsQ0FBQ1EsS0FBRCxFQUFRTixJQUFSLENBQWhCO0FBQ0gsQ0FURDs7QUFjQVosT0FBTyxDQUFDcUIsa0JBQVIsR0FBOEJDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxPQUFaLElBQXVCRixPQUFPLENBQUNDLEdBQVIsQ0FBWUMsT0FBWixLQUF3QixPQUFoRCxHQUEyRHpCLE9BQU8sQ0FBQzBCLGdCQUFuRSxHQUFzRjFCLE9BQU8sQ0FBQzJCLFlBQTNIIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IF8gPSByZXF1aXJlKCdyay11dGlscycpLl87XG5jb25zdCB7IEludmFsaWRDb25maWd1cmF0aW9uIH0gPSByZXF1aXJlKCcuLi91dGlscy9FcnJvcnMnKTtcbmNvbnN0IExpdGVyYWwgPSByZXF1aXJlKCcuLi9lbnVtL0xpdGVyYWwnKTtcblxuZXhwb3J0cy5yZXF1aXJlRmVhdHVyZXMgPSBmdW5jdGlvbiAoZmVhdHVyZXMsIGFwcCwgbWlkZGxld2FyZSkge1xuICAgIGxldCBoYXNOb3RFbmFibGVkID0gXy5maW5kKF8uY2FzdEFycmF5KGZlYXR1cmVzKSwgZmVhdHVyZSA9PiAhYXBwLmVuYWJsZWQoZmVhdHVyZSkpO1xuXG4gICAgaWYgKGhhc05vdEVuYWJsZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRDb25maWd1cmF0aW9uKFxuICAgICAgICAgICAgYE1pZGRsZXdhcmUgXCIke21pZGRsZXdhcmV9XCIgcmVxdWlyZXMgXCIke2hhc05vdEVuYWJsZWR9XCIgZmVhdHVyZSB0byBiZSBlbmFibGVkLmAsXG4gICAgICAgICAgICBhcHAsXG4gICAgICAgICAgICBgbWlkZGxld2FyZXMuJHttaWRkbGV3YXJlfWBcbiAgICAgICAgKTtcbiAgICB9XG59O1xuXG5leHBvcnRzLmhhc01ldGhvZCA9IGZ1bmN0aW9uIGhhc01ldGhvZChvYmosIG5hbWUpIHtcbiAgICBjb25zdCBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIG5hbWUpOyAgICBcbiAgICBsZXQgaGFzID0gISFkZXNjICYmIHR5cGVvZiBkZXNjLnZhbHVlID09PSAnZnVuY3Rpb24nO1xuICAgIGlmIChoYXMpIHJldHVybiB0cnVlO1xuXG4gICAgbGV0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaik7XG4gICAgaWYgKHByb3RvID09PSBPYmplY3QucHJvdG90eXBlKSByZXR1cm4gaGFzO1xuXG4gICAgcmV0dXJuIGhhc01ldGhvZChwcm90bywgbmFtZSk7XG59O1xuXG4vKipcbiAqIHdoZW4gcnVubmluZyB3aXRoIFtOT0RFX1JUPWJhYmVsXSwgZGlyZWN0bHkgdXNlIHNvdXJjZSBmaWxlc1xuICovXG5leHBvcnRzLmRlZmF1bHRCYWNrZW5kUGF0aCA9IChwcm9jZXNzLmVudi5OT0RFX1JUICYmIHByb2Nlc3MuZW52Lk5PREVfUlQgPT09ICdiYWJlbCcpID8gTGl0ZXJhbC5CQUNLRU5EX1NSQ19QQVRIIDogTGl0ZXJhbC5CQUNLRU5EX1BBVEg7Il19