"use strict";

require("source-map-support/register");

const {
  InvalidConfiguration
} = require('@genx/error');

let createMiddleware = (opt, app) => {
  if (!opt || !opt.strategy) {
    throw new InvalidConfiguration('Missing strategy name.', app, 'middlewares.passportAuth.strategy');
  }

  let passportService = app.getService('passport');

  if (!passportService) {
    throw new InvalidConfiguration('Passport feature is not enabled.', app, 'passport');
  }

  return passportService.authenticate(opt.strategy, opt.options);
};

module.exports = createMiddleware;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlcy9wYXNzcG9ydEF1dGguanMiXSwibmFtZXMiOlsiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJyZXF1aXJlIiwiY3JlYXRlTWlkZGxld2FyZSIsIm9wdCIsImFwcCIsInN0cmF0ZWd5IiwicGFzc3BvcnRTZXJ2aWNlIiwiZ2V0U2VydmljZSIsImF1dGhlbnRpY2F0ZSIsIm9wdGlvbnMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU07QUFBRUEsRUFBQUE7QUFBRixJQUEyQkMsT0FBTyxDQUFDLGFBQUQsQ0FBeEM7O0FBZUEsSUFBSUMsZ0JBQWdCLEdBQUcsQ0FBQ0MsR0FBRCxFQUFNQyxHQUFOLEtBQWM7QUFDakMsTUFBSSxDQUFDRCxHQUFELElBQVEsQ0FBQ0EsR0FBRyxDQUFDRSxRQUFqQixFQUEyQjtBQUN2QixVQUFNLElBQUlMLG9CQUFKLENBQ0Ysd0JBREUsRUFFRkksR0FGRSxFQUdGLG1DQUhFLENBQU47QUFLSDs7QUFFRCxNQUFJRSxlQUFlLEdBQUdGLEdBQUcsQ0FBQ0csVUFBSixDQUFlLFVBQWYsQ0FBdEI7O0FBRUEsTUFBSSxDQUFDRCxlQUFMLEVBQXNCO0FBQ2xCLFVBQU0sSUFBSU4sb0JBQUosQ0FDRixrQ0FERSxFQUVGSSxHQUZFLEVBR0YsVUFIRSxDQUFOO0FBS0g7O0FBRUQsU0FBT0UsZUFBZSxDQUFDRSxZQUFoQixDQUE2QkwsR0FBRyxDQUFDRSxRQUFqQyxFQUEyQ0YsR0FBRyxDQUFDTSxPQUEvQyxDQUFQO0FBQ0gsQ0FwQkQ7O0FBc0JBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJULGdCQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCB7IEludmFsaWRDb25maWd1cmF0aW9uIH0gPSByZXF1aXJlKCdAZ2VueC9lcnJvcicpO1xuXG4vKipcbiAqIFBhc3Nwb3J0IGluaXRpYWxpemF0aW9uIG1pZGRsZXdhcmUsIHJlcXVpcmVkIHRvIGluaXRpYWxpemUgUGFzc3BvcnQgc2VydmljZS5cbiAqIEBtb2R1bGUgTWlkZGxld2FyZV9QYXNzcG9ydEF1dGhcbiAqL1xuXG4vKipcbiAqIENyZWF0ZSBhIHBhc3Nwb3J0IGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmUuXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0IC0gUGFzc3BvcnQgb3B0aW9uc1xuICogQHByb3BlcnR5IHtzdHJpbmd9IG9wdC5zdHJhdGVneSAtIFBhc3Nwb3J0IHN0cmF0ZWd5XG4gKiBAcHJvcGVydHkge29iamVjdH0gW29wdC5vcHRpb25zXSAtIFBhc3Nwb3J0IHN0cmF0ZWd5IG9wdGlvbnNcbiAqIEBwYXJhbSB7Um91dGFibGV9IGFwcFxuICogQHJldHVybnMge0tvYUFjdGlvbkZ1bmN0aW9ufVxuICovXG5sZXQgY3JlYXRlTWlkZGxld2FyZSA9IChvcHQsIGFwcCkgPT4ge1xuICAgIGlmICghb3B0IHx8ICFvcHQuc3RyYXRlZ3kpIHtcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRDb25maWd1cmF0aW9uKFxuICAgICAgICAgICAgJ01pc3Npbmcgc3RyYXRlZ3kgbmFtZS4nLCBcbiAgICAgICAgICAgIGFwcCwgXG4gICAgICAgICAgICAnbWlkZGxld2FyZXMucGFzc3BvcnRBdXRoLnN0cmF0ZWd5J1xuICAgICAgICApO1xuICAgIH0gICAgXG4gICAgXG4gICAgbGV0IHBhc3Nwb3J0U2VydmljZSA9IGFwcC5nZXRTZXJ2aWNlKCdwYXNzcG9ydCcpO1xuXG4gICAgaWYgKCFwYXNzcG9ydFNlcnZpY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEludmFsaWRDb25maWd1cmF0aW9uKFxuICAgICAgICAgICAgJ1Bhc3Nwb3J0IGZlYXR1cmUgaXMgbm90IGVuYWJsZWQuJyxcbiAgICAgICAgICAgIGFwcCxcbiAgICAgICAgICAgICdwYXNzcG9ydCdcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGFzc3BvcnRTZXJ2aWNlLmF1dGhlbnRpY2F0ZShvcHQuc3RyYXRlZ3ksIG9wdC5vcHRpb25zKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlTWlkZGxld2FyZTsiXX0=