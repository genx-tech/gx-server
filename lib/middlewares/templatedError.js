"use strict";

require("source-map-support/register");

const path = require('path');

const {
  Literal
} = require('..').enum;

const {
  InvalidConfiguration
} = require('../utils/Errors');

const koaError = require('koa-error');

module.exports = (options, app) => {
  if (!options.template) {
    if (options.engine && options.engine !== 'swig') {
      throw new InvalidConfiguration('Missing template option.', app, 'middlewares.templatedError.template');
    }

    options.template = 'defaultError.swig';
  }

  options.template = path.resolve(app.backendPath, Literal.VIEWS_PATH, options.template);

  if (!options.engine) {
    options.engine = 'swig';
  }

  return koaError(options);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlcy90ZW1wbGF0ZWRFcnJvci5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsIkxpdGVyYWwiLCJlbnVtIiwiSW52YWxpZENvbmZpZ3VyYXRpb24iLCJrb2FFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJvcHRpb25zIiwiYXBwIiwidGVtcGxhdGUiLCJlbmdpbmUiLCJyZXNvbHZlIiwiYmFja2VuZFBhdGgiLCJWSUVXU19QQVRIIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQU9BLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQTtBQUFGLElBQWNELE9BQU8sQ0FBQyxJQUFELENBQVAsQ0FBY0UsSUFBbEM7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQTtBQUFGLElBQTJCSCxPQUFPLENBQUMsaUJBQUQsQ0FBeEM7O0FBV0EsTUFBTUksUUFBUSxHQUFHSixPQUFPLENBQUMsV0FBRCxDQUF4Qjs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWlCLENBQUNDLE9BQUQsRUFBVUMsR0FBVixLQUFrQjtBQUMvQixNQUFJLENBQUNELE9BQU8sQ0FBQ0UsUUFBYixFQUF1QjtBQUNuQixRQUFJRixPQUFPLENBQUNHLE1BQVIsSUFBa0JILE9BQU8sQ0FBQ0csTUFBUixLQUFtQixNQUF6QyxFQUFpRDtBQUM3QyxZQUFNLElBQUlQLG9CQUFKLENBQ0YsMEJBREUsRUFFRkssR0FGRSxFQUdGLHFDQUhFLENBQU47QUFLSDs7QUFFREQsSUFBQUEsT0FBTyxDQUFDRSxRQUFSLEdBQW1CLG1CQUFuQjtBQUNIOztBQUVERixFQUFBQSxPQUFPLENBQUNFLFFBQVIsR0FBbUJWLElBQUksQ0FBQ1ksT0FBTCxDQUFhSCxHQUFHLENBQUNJLFdBQWpCLEVBQThCWCxPQUFPLENBQUNZLFVBQXRDLEVBQWtETixPQUFPLENBQUNFLFFBQTFELENBQW5COztBQUVBLE1BQUksQ0FBQ0YsT0FBTyxDQUFDRyxNQUFiLEVBQXFCO0FBQ2pCSCxJQUFBQSxPQUFPLENBQUNHLE1BQVIsR0FBaUIsTUFBakI7QUFDSDs7QUFFRCxTQUFPTixRQUFRLENBQUNHLE9BQUQsQ0FBZjtBQUNILENBcEJEIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogRXJyb3IgcmVzcG9uc2UgbWlkZGxld2FyZSB3aXRoIHRlbXBsYXRlIGVuZ2luZXNcbiAqIEBtb2R1bGUgTWlkZGxld2FyZV9UZW1wbGF0ZWRFcnJvclxuICovXG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7IExpdGVyYWwgfSA9IHJlcXVpcmUoJy4uJykuZW51bTtcbmNvbnN0IHsgSW52YWxpZENvbmZpZ3VyYXRpb24gfSA9IHJlcXVpcmUoJy4uL3V0aWxzL0Vycm9ycycpO1xuXG4vKipcbiAqIEBmdW5jdGlvblxuICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBUZW1wbGF0ZSBvcHRpb25zXG4gKiBAcHJvcGVydHkge3N0cmluZ30gb3B0aW9ucy50ZW1wbGF0ZSAtIFBhdGggdG8gdGVtcGxhdGUgd3JpdHRlbiB3aXRoIHlvdXIgdGVtcGxhdGUgZW5naW5lXG4gKiBAcHJvcGVydHkge3N0cmluZ30gb3B0aW9ucy5lbmdpbmUgLSBQYXRoIHRvIHRlbXBsYXRlIHdyaXR0ZW4gd2l0aCB5b3VyIHRlbXBsYXRlIGVuZ2luZVxuICogQHByb3BlcnR5IHtib29sfSBvcHRpb25zLmNhY2hlIC0gUGF0aCB0byB0ZW1wbGF0ZSB3cml0dGVuIHdpdGggeW91ciB0ZW1wbGF0ZSBlbmdpbmUsIGRlZmF1bHQ6IE5PREVfRU5WICE9ICdkZXZlbG9wbWVudCdcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbb3B0aW9ucy5lbnY9J2RldmVsb3BtZW50J10gLSBQYXRoIHRvIHRlbXBsYXRlIHdyaXR0ZW4gd2l0aCB5b3VyIHRlbXBsYXRlIGVuZ2luZVxuICogQHByb3BlcnR5IHtBcnJheS48c3RyaW5nPn0gb3B0aW9ucy5hY2NlcHRzIC0gTWltZXR5cGVzIHBhc3NlZCB0byBjdHguYWNjZXB0cywgZGVmYXVsdDogWyAnaHRtbCcsICd0ZXh0JywgJ2pzb24nIF1cbiAqKi9cbmNvbnN0IGtvYUVycm9yID0gcmVxdWlyZSgna29hLWVycm9yJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gKG9wdGlvbnMsIGFwcCkgPT4ge1xuICAgIGlmICghb3B0aW9ucy50ZW1wbGF0ZSkgeyAgICAgICAgXG4gICAgICAgIGlmIChvcHRpb25zLmVuZ2luZSAmJiBvcHRpb25zLmVuZ2luZSAhPT0gJ3N3aWcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZENvbmZpZ3VyYXRpb24oXG4gICAgICAgICAgICAgICAgJ01pc3NpbmcgdGVtcGxhdGUgb3B0aW9uLicsXG4gICAgICAgICAgICAgICAgYXBwLFxuICAgICAgICAgICAgICAgICdtaWRkbGV3YXJlcy50ZW1wbGF0ZWRFcnJvci50ZW1wbGF0ZSdcbiAgICAgICAgICAgICk7ICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSAnZGVmYXVsdEVycm9yLnN3aWcnO1xuICAgIH1cblxuICAgIG9wdGlvbnMudGVtcGxhdGUgPSBwYXRoLnJlc29sdmUoYXBwLmJhY2tlbmRQYXRoLCBMaXRlcmFsLlZJRVdTX1BBVEgsIG9wdGlvbnMudGVtcGxhdGUpOyBcblxuICAgIGlmICghb3B0aW9ucy5lbmdpbmUpIHtcbiAgICAgICAgb3B0aW9ucy5lbmdpbmUgPSAnc3dpZyc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGtvYUVycm9yKG9wdGlvbnMpO1xufSAiXX0=